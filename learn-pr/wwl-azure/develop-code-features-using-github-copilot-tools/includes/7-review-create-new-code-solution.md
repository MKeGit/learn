Your challenge was to update the `QuarterlySalesReport` method to achieve the following requirements:

1. Update the report format to display the department sales information as a table. Before and after sample output is provided in the task details. You need to match the "after" output format as closely as possible.

1. Identify the three largest sales orders for each quarter and include them in the quarterly sales report. For each of the three top sales, list the product ID, the quantity sold, the unit price, the total sales amount, the profit, and the profit percentage. Format the top sales order information in a table. Before and after sample output is provided in the task details. You need to match the "after" output format as closely as possible.

This review describes the Copilot Chat features and prompts used to complete the challenge.

> [!NOTE]
> The responses generated by GitHub Copilot Chat are based on chat history and the context provided by the user. Other factors, such as AI model updates, may also influence responses. Your results should be similar to the results shown below with some variations expected.

The following sections show one possible solution for the challenge from the previous unit.

## Review the "Format the department sales information" solution

The challenge instructions have you download the sample app for this challenge.

1. Open the Program.cs file in Visual Studio Code.

1. Select the entire `QuarterlySalesReport` method.

1. To open the inline chat interface, press the "Ctrl" + "I" keys.

1. Enter the following prompt:

    ```output
    Update the QuarterlySalesReport method to format the reported department sales information as a table. Each column should be aligned. The left column should be 22 characters wide. The remaining columns should be 20 characters wide. Each column should have a right-aligned header. The sales data should be right-aligned and padded to fit the column with.
    ```

1. Review the suggestions provided by GitHub Copilot and then select **Accept**.

1. Select the entire `QuarterlySalesReport` method.

1. To open the inline chat interface, press the "Ctrl" + "I" keys.

1. Enter the following prompt:

    ```output
    Use extended ASCII characters to add border lines to the table. Border lines should enclose the table perimeter. Border lines should separate the interior columns of the table. 
    ```

    Manually adjust the position of the column 1 right-side vertical line one position to the right. This aligns the interior vertical lines with the perimeter and header lines.

    ```csharp
    Console.WriteLine("│ {0,-22}│ {1,17} │ {2,17} │ {3,17} │", department.Key, formattedDepartmentSalesAmount, formattedDepartmentProfitAmount, formattedDepartmentProfitPercentage);
    ```

1. Review the suggestions provided by GitHub Copilot and then select **Accept**.

1. Save the changes to the Program.cs file.

1. Run the application and verify that the quarterly sales report output includes a table of department sales results.

    Your quarterly sales report should look similar to the following output:

    ```output
    Quarterly Sales Report
    ----------------------
    Q1: Sales: $2,098,948.87, Profit: $266,548.80, Profit Percentage: 7.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $227,101.75 │        $31,619.50 │             11.00 │
    │ Children's Clothing   │       $242,999.83 │        $32,129.93 │              9.00 │
    │ Footwear              │       $309,579.27 │        $37,846.03 │              7.00 │
    │ Men's Clothing        │       $256,699.00 │        $31,627.33 │             11.00 │
    │ Outerwear             │       $259,274.20 │        $27,614.65 │              5.00 │
    │ Sportswear            │       $261,332.33 │        $35,702.48 │             10.00 │
    │ Undergarments         │       $291,343.22 │        $38,740.59 │              9.00 │
    │ Women's Clothing      │       $250,619.28 │        $31,268.29 │             14.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Q2: Sales: $2,035,550.16, Profit: $253,516.25, Profit Percentage: 11.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $284,685.66 │        $34,442.28 │             17.00 │
    │ Children's Clothing   │       $285,753.69 │        $36,672.14 │             20.00 │
    │ Footwear              │       $232,121.77 │        $28,406.40 │              9.00 │
    │ Men's Clothing        │       $269,787.82 │        $33,061.27 │             11.00 │
    │ Outerwear             │       $190,096.90 │        $25,230.19 │             13.00 │
    │ Sportswear            │       $263,685.51 │        $31,183.94 │             20.00 │
    │ Undergarments         │       $246,857.39 │        $29,287.72 │             18.00 │
    │ Women's Clothing      │       $262,561.42 │        $35,232.32 │             11.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Q3: Sales: $1,959,738.57, Profit: $249,994.39, Profit Percentage: 12.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $268,249.09 │        $33,662.40 │             16.00 │
    │ Children's Clothing   │       $262,402.85 │        $32,550.39 │              7.00 │
    │ Footwear              │       $268,383.13 │        $33,416.99 │             14.00 │
    │ Men's Clothing        │       $246,654.07 │        $33,440.20 │             12.00 │
    │ Outerwear             │       $216,239.78 │        $28,683.07 │             16.00 │
    │ Sportswear            │       $244,253.22 │        $29,269.02 │             13.00 │
    │ Undergarments         │       $237,058.27 │        $31,402.88 │             19.00 │
    │ Women's Clothing      │       $216,498.16 │        $27,569.42 │              9.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Q4: Sales: $2,056,371.76, Profit: $273,122.03, Profit Percentage: 8.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $329,926.72 │        $49,008.34 │             18.00 │
    │ Children's Clothing   │       $161,918.53 │        $23,062.50 │              9.00 │
    │ Footwear              │       $255,455.17 │        $33,934.76 │              8.00 │
    │ Men's Clothing        │       $221,264.27 │        $24,772.73 │              8.00 │
    │ Outerwear             │       $299,514.01 │        $41,179.09 │              8.00 │
    │ Sportswear            │       $314,023.68 │        $42,038.11 │             20.00 │
    │ Undergarments         │       $202,815.48 │        $23,954.48 │              7.00 │
    │ Women's Clothing      │       $271,453.91 │        $35,172.04 │             16.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    ```

### Review the "Display the top three sales orders by quarter" solution

1. Select the entire `QuarterlySalesReport` method.

1. To open the inline chat interface, press the "Ctrl" + "I" keys.

1. Enter the following prompt:

    ```output
    Update the QuarterlySalesReport method to include calculations that identify the top 3 sales orders during each quarter. Select the top 3 orders based on the total sales amount for the order (quantitySold * unitPrice). Include the top 3 orders in the report output. For the top three orders, display the product ID, the quantity sold, the unit price, the total sales amount, the profit, and profit percentage.
    
    ```

1. Review the suggestions provided by GitHub Copilot and then select **Accept**.

    You can save and then run the application after accepting updates. This may help you locate and review the updated code.

1. Select the entire `QuarterlySalesReport` method.

1. To open the inline chat interface, press the "Ctrl" + "I" keys.

1. Enter the following prompt:

    ```output
    Update the order in which the top three sales orders are listed in the report. List the top three orders in descending order of profit.
    
    ```

1. Review the suggestions provided by GitHub Copilot and then select **Accept**.

1. Select the entire `QuarterlySalesReport` method.

1. To open the inline chat interface, press the "Ctrl" + "I" keys.

1. Enter the following prompt:

    ```output
    Update the QuarterlySalesReport method to display all of information for the top three orders in a table. The left column should be 22 characters wide. The remaining columns should be 20 characters wide. Each column should have a right-aligned header. The sales data should be right-aligned and padded to fit the column with.
    
    ```

1. Review the suggestions provided by GitHub Copilot and then select **Accept**.

1. Select the entire `QuarterlySalesReport` method.

1. To open the inline chat interface, press the "Ctrl" + "I" keys.

1. Enter the following prompt:

    ```output
    Use extended ASCII characters to add border lines to the table. Border lines should enclose the table perimeter. Border lines should separate the interior columns of the table. 
    ```

1. Review the suggestions provided by GitHub Copilot and then select **Accept**.

1. Save the changes to the Program.cs file.

1. Run the application and verify that the quarterly sales report output includes a table of department sales results.

    Your quarterly sales report should look similar to the following output:

    ```output
    Quarterly Sales Report
    ----------------------
    Q1: Sales: $2,147,913.85, Profit: $259,780.34, Profit Percentage: 6.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $250,965.22 │        $32,137.16 │             10.00 │
    │ Children's Clothing   │       $240,996.59 │        $30,624.26 │             20.00 │
    │ Footwear              │       $350,495.72 │        $44,661.94 │             17.00 │
    │ Men's Clothing        │       $179,416.69 │        $19,491.29 │             13.00 │
    │ Outerwear             │       $341,525.29 │        $47,556.50 │             16.00 │
    │ Sportswear            │       $216,901.82 │        $21,858.47 │              7.00 │
    │ Undergarments         │       $298,357.33 │        $35,451.12 │              6.00 │
    │ Women's Clothing      │       $269,255.19 │        $27,999.61 │             20.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Top 3 Sales Orders:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Product ID       │   Quantity Sold   │    Unit Price     │   Total Sales     │      Profit       │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ SPRT-702-S-BK-CA1     │                96 │           $295.33 │        $28,351.45 │         $4,536.23 │             16.00 │
    │ OUTR-609-M-GR-JP1     │                92 │           $243.62 │        $22,412.59 │         $4,482.52 │             20.00 │
    │ ACCS-437-S-GY-JP1     │                96 │           $268.76 │        $25,800.68 │         $4,128.11 │             16.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Q2: Sales: $2,003,845.44, Profit: $244,961.30, Profit Percentage: 5.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $209,829.83 │        $26,133.08 │             12.00 │
    │ Children's Clothing   │       $262,972.68 │        $34,363.99 │             15.00 │
    │ Footwear              │       $362,836.17 │        $43,653.95 │              5.00 │
    │ Men's Clothing        │       $259,752.19 │        $29,271.83 │             15.00 │
    │ Outerwear             │       $196,229.55 │        $22,143.81 │             14.00 │
    │ Sportswear            │       $304,231.54 │        $36,642.49 │             10.00 │
    │ Undergarments         │       $159,844.19 │        $20,731.42 │             19.00 │
    │ Women's Clothing      │       $248,149.28 │        $32,020.74 │              6.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Top 3 Sales Orders:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Product ID       │   Quantity Sold   │    Unit Price     │   Total Sales     │      Profit       │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ CHLD-368-XL-WT-UK2    │                87 │           $290.23 │        $25,250.21 │         $4,292.54 │             17.00 │
    │ SPRT-732-S-YL-UK2     │                86 │           $265.58 │        $22,839.86 │         $3,882.78 │             17.00 │
    │ MENS-128-XL-WT-JP1    │                87 │           $222.23 │        $19,334.37 │         $3,673.53 │             19.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Q3: Sales: $2,261,407.77, Profit: $277,077.73, Profit Percentage: 18.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $291,046.00 │        $36,782.43 │              9.00 │
    │ Children's Clothing   │       $221,364.18 │        $26,993.37 │              7.00 │
    │ Footwear              │       $237,884.17 │        $32,777.70 │             18.00 │
    │ Men's Clothing        │       $332,047.47 │        $41,620.56 │              7.00 │
    │ Outerwear             │       $217,888.26 │        $24,129.85 │             17.00 │
    │ Sportswear            │       $325,778.95 │        $43,229.56 │             17.00 │
    │ Undergarments         │       $292,301.79 │        $36,193.42 │              5.00 │
    │ Women's Clothing      │       $343,096.95 │        $35,350.83 │             12.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Top 3 Sales Orders:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Product ID       │   Quantity Sold   │    Unit Price     │   Total Sales     │      Profit       │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ MENS-120-XL-BK-UK3    │                98 │           $235.28 │        $23,057.74 │         $4,611.55 │             20.00 │
    │ OUTR-609-XS-OR-JP1    │                96 │           $270.57 │        $25,975.01 │         $4,156.00 │             16.00 │
    │ WOMN-225-XS-RD-UK3    │                95 │           $247.99 │        $23,559.14 │         $3,533.87 │             15.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Q4: Sales: $2,076,474.81, Profit: $255,995.79, Profit Percentage: 20.00%
    By Department:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Department       │       Sales       │       Profit      │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ Accessories           │       $230,203.59 │        $26,018.53 │             20.00 │
    │ Children's Clothing   │       $208,243.96 │        $24,647.41 │              5.00 │
    │ Footwear              │       $333,552.70 │        $37,319.89 │             15.00 │
    │ Men's Clothing        │       $265,576.45 │        $29,605.44 │              9.00 │
    │ Outerwear             │       $221,220.08 │        $31,250.72 │              6.00 │
    │ Sportswear            │       $310,761.93 │        $39,728.56 │             16.00 │
    │ Undergarments         │       $260,660.71 │        $36,903.27 │             19.00 │
    │ Women's Clothing      │       $246,255.40 │        $30,521.98 │             20.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┘
    
    Top 3 Sales Orders:
    ┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┐
    │      Product ID       │   Quantity Sold   │    Unit Price     │   Total Sales     │      Profit       │ Profit Percentage │
    ├───────────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┤
    │ UNDR-819-XS-BL-US2    │                87 │           $293.23 │        $25,510.94 │         $4,847.08 │             19.00 │
    │ SPRT-710-S-OR-JP1     │                87 │           $279.28 │        $24,297.67 │         $4,130.60 │             17.00 │
    │ SPRT-726-L-BL-JP1     │                94 │           $198.53 │        $18,662.13 │         $3,732.43 │             20.00 │
    └───────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┘

    ```

### Review the solution code

You can review the code updates for each of the challenge sections below.

#### Starter code

This is the starter code for the challenge.

```csharp
namespace ReportGenerator
{
    class QuarterlyIncomeReport
    {
        static void Main(string[] args)
        {
            // create a new instance of the class
            QuarterlyIncomeReport report = new QuarterlyIncomeReport();

            // call the GenerateSalesData method
            SalesData[] salesData = report.GenerateSalesData();


            // call the QuarterlySalesReport method
            report.QuarterlySalesReport(salesData);

        }

        /* public struct SalesData includes the following fields: date sold, department name, product ID, quantity sold, unit price */
        public struct SalesData
        {
            public DateOnly dateSold;
            public string departmentName;
            public string productID;
            public int quantitySold;
            public double unitPrice;
            public double baseCost;
            public int volumeDiscount;
        }

        public struct ProdDepartments
        {
            public static string[] departmentNames = { "Men's Clothing", "Women's Clothing", "Children's Clothing", "Accessories", "Footwear", "Outerwear", "Sportswear", "Undergarments" };
            public static string[] departmentAbbreviations = { "MENS", "WOMN", "CHLD", "ACCS", "FOOT", "OUTR", "SPRT", "UNDR" };
        }

        public struct ManufacturingSites
        {
            public static string[] manufacturingSites = { "US1", "US2", "US3", "UK1", "UK2", "UK3", "JP1", "JP2", "JP3", "CA1" };
        }

        /* the GenerateSalesData method returns 1000 SalesData records. It assigns random values to each field of the data structure */
        public SalesData[] GenerateSalesData()
        {
            SalesData[] salesData = new SalesData[1000];
            Random random = new Random();

            for (int i = 0; i < 1000; i++)
            {
                salesData[i].dateSold = new DateOnly(2023, random.Next(1, 13), random.Next(1, 29));
                salesData[i].departmentName = ProdDepartments.departmentNames[random.Next(0, ProdDepartments.departmentNames.Length)];

                int indexOfDept = Array.IndexOf(ProdDepartments.departmentNames, salesData[i].departmentName);
                string deptAbb = ProdDepartments.departmentAbbreviations[indexOfDept];
                string firstDigit = (indexOfDept + 1).ToString();
                string nextTwoDigits = random.Next(1, 100).ToString("D2");
                string sizeCode = new string[] { "XS", "S", "M", "L", "XL" }[random.Next(0, 5)];
                string colorCode = new string[] { "BK", "BL", "GR", "RD", "YL", "OR", "WT", "GY" }[random.Next(0, 8)];
                string manufacturingSite = ManufacturingSites.manufacturingSites[random.Next(0, ManufacturingSites.manufacturingSites.Length)];

                salesData[i].productID = $"{deptAbb}-{firstDigit}{nextTwoDigits}-{sizeCode}-{colorCode}-{manufacturingSite}";
                salesData[i].quantitySold = random.Next(1, 101);
                salesData[i].unitPrice = random.Next(25, 300) + random.NextDouble();
                salesData[i].baseCost = salesData[i].unitPrice * (1 - (random.Next(5, 21) / 100.0));
                salesData[i].volumeDiscount = (int)(salesData[i].quantitySold * 0.1);

            }

            return salesData;
        }


        public void QuarterlySalesReport(SalesData[] salesData)
        {
            // create a dictionary to store the quarterly sales data
            Dictionary<string, double> quarterlySales = new Dictionary<string, double>();
            Dictionary<string, double> quarterlyProfit = new Dictionary<string, double>();
            Dictionary<string, double> quarterlyProfitPercentage = new Dictionary<string, double>();

            // create a dictionary to store the quarterly sales data by department
            Dictionary<string, Dictionary<string, double>> quarterlySalesByDepartment = new Dictionary<string, Dictionary<string, double>>();
            Dictionary<string, Dictionary<string, double>> quarterlyProfitByDepartment = new Dictionary<string, Dictionary<string, double>>();
            Dictionary<string, Dictionary<string, double>> quarterlyProfitPercentageByDepartment = new Dictionary<string, Dictionary<string, double>>();

            // iterate through the sales data
            foreach (SalesData data in salesData)
            {
                // calculate the total sales for each quarter
                string quarter = GetQuarter(data.dateSold.Month);
                double totalSales = data.quantitySold * data.unitPrice;
                double totalCost = data.quantitySold * data.baseCost;
                double profit = totalSales - totalCost;
                double profitPercentage = (profit / totalSales) * 100;

                // calculate the total sales, profit, and profit percentage by department
                if (!quarterlySalesByDepartment.ContainsKey(quarter))
                {
                    quarterlySalesByDepartment.Add(quarter, new Dictionary<string, double>());
                    quarterlyProfitByDepartment.Add(quarter, new Dictionary<string, double>());
                    quarterlyProfitPercentageByDepartment.Add(quarter, new Dictionary<string, double>());
                }

                if (quarterlySalesByDepartment[quarter].ContainsKey(data.departmentName))
                {
                    quarterlySalesByDepartment[quarter][data.departmentName] += totalSales;
                    quarterlyProfitByDepartment[quarter][data.departmentName] += profit;
                }
                else
                {
                    quarterlySalesByDepartment[quarter].Add(data.departmentName, totalSales);
                    quarterlyProfitByDepartment[quarter].Add(data.departmentName, profit);
                }

                if (!quarterlyProfitPercentageByDepartment[quarter].ContainsKey(data.departmentName))
                {
                    quarterlyProfitPercentageByDepartment[quarter].Add(data.departmentName, profitPercentage);
                }

                // calculate the total sales and profit for each quarter
                if (quarterlySales.ContainsKey(quarter))
                {
                    quarterlySales[quarter] += totalSales;
                    quarterlyProfit[quarter] += profit;
                }
                else
                {
                    quarterlySales.Add(quarter, totalSales);
                    quarterlyProfit.Add(quarter, profit);
                }

                if (!quarterlyProfitPercentage.ContainsKey(quarter))
                {
                    quarterlyProfitPercentage.Add(quarter, profitPercentage);
                }
            }

            // display the quarterly sales report
            Console.WriteLine("Quarterly Sales Report");
            Console.WriteLine("----------------------");

            // sort the quarterly sales by key (quarter)
            var sortedQuarterlySales = quarterlySales.OrderBy(q => q.Key);

            foreach (KeyValuePair<string, double> quarter in sortedQuarterlySales)
            {
                // format the sales amount as currency using regional settings
                string formattedSalesAmount = quarter.Value.ToString("C");
                string formattedProfitAmount = quarterlyProfit[quarter.Key].ToString("C");
                string formattedProfitPercentage = quarterlyProfitPercentage[quarter.Key].ToString("F2");

                Console.WriteLine("{0}: Sales: {1}, Profit: {2}, Profit Percentage: {3}%", quarter.Key, formattedSalesAmount, formattedProfitAmount, formattedProfitPercentage);

                // display the quarterly sales, profit, and profit percentage by department
                Console.WriteLine("By Department:");
                var sortedQuarterlySalesByDepartment = quarterlySalesByDepartment[quarter.Key].OrderBy(d => d.Key);

                foreach (KeyValuePair<string, double> department in sortedQuarterlySalesByDepartment)
                {
                    string formattedDepartmentSalesAmount = department.Value.ToString("C");
                    string formattedDepartmentProfitAmount = quarterlyProfitByDepartment[quarter.Key][department.Key].ToString("C");
                    string formattedDepartmentProfitPercentage = quarterlyProfitPercentageByDepartment[quarter.Key][department.Key].ToString("F2");

                    Console.WriteLine("Department: {0}, Sales: {1}, Profit: {2}, Profit Percentage: {3}%", department.Key, formattedDepartmentSalesAmount, formattedDepartmentProfitAmount, formattedDepartmentProfitPercentage);
                }

                Console.WriteLine();
            }
        }

        public string GetQuarter(int month)
        {
            if (month >= 1 && month <= 3)
            {
                return "Q1";
            }
            else if (month >= 4 && month <= 6)
            {
                return "Q2";
            }
            else if (month >= 7 && month <= 9)
            {
                return "Q3";
            }
            else
            {
                return "Q4";
            }
        }
    }
}
```

#### Solution code for challenge section 1

This is the solution code at the end of the first challenge section.

```csharp
namespace ReportGenerator
{
    class QuarterlyIncomeReport
    {
        static void Main(string[] args)
        {
            // create a new instance of the class
            QuarterlyIncomeReport report = new QuarterlyIncomeReport();

            // call the GenerateSalesData method
            SalesData[] salesData = report.GenerateSalesData();


            // call the QuarterlySalesReport method
            report.QuarterlySalesReport(salesData);

        }

        /* public struct SalesData includes the following fields: date sold, department name, product ID, quantity sold, unit price */
        public struct SalesData
        {
            public DateOnly dateSold;
            public string departmentName;
            public string productID;
            public int quantitySold;
            public double unitPrice;
            public double baseCost;
            public int volumeDiscount;
        }

        public struct ProdDepartments
        {
            public static string[] departmentNames = { "Men's Clothing", "Women's Clothing", "Children's Clothing", "Accessories", "Footwear", "Outerwear", "Sportswear", "Undergarments" };
            public static string[] departmentAbbreviations = { "MENS", "WOMN", "CHLD", "ACCS", "FOOT", "OUTR", "SPRT", "UNDR" };
        }

        public struct ManufacturingSites
        {
            public static string[] manufacturingSites = { "US1", "US2", "US3", "UK1", "UK2", "UK3", "JP1", "JP2", "JP3", "CA1" };
        }

        /* the GenerateSalesData method returns 1000 SalesData records. It assigns random values to each field of the data structure */
        public SalesData[] GenerateSalesData()
        {
            SalesData[] salesData = new SalesData[1000];
            Random random = new Random();

            for (int i = 0; i < 1000; i++)
            {
                salesData[i].dateSold = new DateOnly(2023, random.Next(1, 13), random.Next(1, 29));
                salesData[i].departmentName = ProdDepartments.departmentNames[random.Next(0, ProdDepartments.departmentNames.Length)];

                int indexOfDept = Array.IndexOf(ProdDepartments.departmentNames, salesData[i].departmentName);
                string deptAbb = ProdDepartments.departmentAbbreviations[indexOfDept];
                string firstDigit = (indexOfDept + 1).ToString();
                string nextTwoDigits = random.Next(1, 100).ToString("D2");
                string sizeCode = new string[] { "XS", "S", "M", "L", "XL" }[random.Next(0, 5)];
                string colorCode = new string[] { "BK", "BL", "GR", "RD", "YL", "OR", "WT", "GY" }[random.Next(0, 8)];
                string manufacturingSite = ManufacturingSites.manufacturingSites[random.Next(0, ManufacturingSites.manufacturingSites.Length)];

                salesData[i].productID = $"{deptAbb}-{firstDigit}{nextTwoDigits}-{sizeCode}-{colorCode}-{manufacturingSite}";
                salesData[i].quantitySold = random.Next(1, 101);
                salesData[i].unitPrice = random.Next(25, 300) + random.NextDouble();
                salesData[i].baseCost = salesData[i].unitPrice * (1 - (random.Next(5, 21) / 100.0));
                salesData[i].volumeDiscount = (int)(salesData[i].quantitySold * 0.1);

            }

            return salesData;
        }


        public void QuarterlySalesReport(SalesData[] salesData)
        {
            // create a dictionary to store the quarterly sales data
            Dictionary<string, double> quarterlySales = new Dictionary<string, double>();
            Dictionary<string, double> quarterlyProfit = new Dictionary<string, double>();
            Dictionary<string, double> quarterlyProfitPercentage = new Dictionary<string, double>();

            // create a dictionary to store the quarterly sales data by department
            Dictionary<string, Dictionary<string, double>> quarterlySalesByDepartment = new Dictionary<string, Dictionary<string, double>>();
            Dictionary<string, Dictionary<string, double>> quarterlyProfitByDepartment = new Dictionary<string, Dictionary<string, double>>();
            Dictionary<string, Dictionary<string, double>> quarterlyProfitPercentageByDepartment = new Dictionary<string, Dictionary<string, double>>();

            // iterate through the sales data
            foreach (SalesData data in salesData)
            {
            // calculate the total sales for each quarter
            string quarter = GetQuarter(data.dateSold.Month);
            double totalSales = data.quantitySold * data.unitPrice;
            double totalCost = data.quantitySold * data.baseCost;
            double profit = totalSales - totalCost;
            double profitPercentage = (profit / totalSales) * 100;

            // calculate the total sales, profit, and profit percentage by department
            if (!quarterlySalesByDepartment.ContainsKey(quarter))
            {
                quarterlySalesByDepartment.Add(quarter, new Dictionary<string, double>());
                quarterlyProfitByDepartment.Add(quarter, new Dictionary<string, double>());
                quarterlyProfitPercentageByDepartment.Add(quarter, new Dictionary<string, double>());
            }

            if (quarterlySalesByDepartment[quarter].ContainsKey(data.departmentName))
            {
                quarterlySalesByDepartment[quarter][data.departmentName] += totalSales;
                quarterlyProfitByDepartment[quarter][data.departmentName] += profit;
            }
            else
            {
                quarterlySalesByDepartment[quarter].Add(data.departmentName, totalSales);
                quarterlyProfitByDepartment[quarter].Add(data.departmentName, profit);
            }

            if (!quarterlyProfitPercentageByDepartment[quarter].ContainsKey(data.departmentName))
            {
                quarterlyProfitPercentageByDepartment[quarter].Add(data.departmentName, profitPercentage);
            }

            // calculate the total sales and profit for each quarter
            if (quarterlySales.ContainsKey(quarter))
            {
                quarterlySales[quarter] += totalSales;
                quarterlyProfit[quarter] += profit;
            }
            else
            {
                quarterlySales.Add(quarter, totalSales);
                quarterlyProfit.Add(quarter, profit);
            }

            if (!quarterlyProfitPercentage.ContainsKey(quarter))
            {
                quarterlyProfitPercentage.Add(quarter, profitPercentage);
            }
            }

            // display the quarterly sales report
            Console.WriteLine("Quarterly Sales Report");
            Console.WriteLine("----------------------");

            // sort the quarterly sales by key (quarter)
            var sortedQuarterlySales = quarterlySales.OrderBy(q => q.Key);

            foreach (KeyValuePair<string, double> quarter in sortedQuarterlySales)
            {
            // format the sales amount as currency using regional settings
            string formattedSalesAmount = quarter.Value.ToString("C");
            string formattedProfitAmount = quarterlyProfit[quarter.Key].ToString("C");
            string formattedProfitPercentage = quarterlyProfitPercentage[quarter.Key].ToString("F2");

            Console.WriteLine("{0}: Sales: {1}, Profit: {2}, Profit Percentage: {3}%", quarter.Key, formattedSalesAmount, formattedProfitAmount, formattedProfitPercentage);

            // display the quarterly sales, profit, and profit percentage by department
            Console.WriteLine("By Department:");
            var sortedQuarterlySalesByDepartment = quarterlySalesByDepartment[quarter.Key].OrderBy(d => d.Key);

            // Print table headers
            Console.WriteLine("┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐");
            Console.WriteLine("│      Department       │       Sales       │       Profit      │ Profit Percentage │");
            Console.WriteLine("├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤");

            foreach (KeyValuePair<string, double> department in sortedQuarterlySalesByDepartment)
            {
                string formattedDepartmentSalesAmount = department.Value.ToString("C");
                string formattedDepartmentProfitAmount = quarterlyProfitByDepartment[quarter.Key][department.Key].ToString("C");
                string formattedDepartmentProfitPercentage = quarterlyProfitPercentageByDepartment[quarter.Key][department.Key].ToString("F2");

                Console.WriteLine("│ {0,-22}│ {1,17} │ {2,17} │ {3,17} │", department.Key, formattedDepartmentSalesAmount, formattedDepartmentProfitAmount, formattedDepartmentProfitPercentage);
            }

            Console.WriteLine("└───────────────────────┴───────────────────┴───────────────────┴───────────────────┘");
            Console.WriteLine();
            }
        }

        public string GetQuarter(int month)
        {
            if (month >= 1 && month <= 3)
            {
                return "Q1";
            }
            else if (month >= 4 && month <= 6)
            {
                return "Q2";
            }
            else if (month >= 7 && month <= 9)
            {
                return "Q3";
            }
            else
            {
                return "Q4";
            }
        }
    }
}

```

#### Solution code for challenge section 2

This is the solution code at the end of the second challenge section.

```csharp
namespace ReportGenerator
{
    class QuarterlyIncomeReport
    {
        static void Main(string[] args)
        {
            // create a new instance of the class
            QuarterlyIncomeReport report = new QuarterlyIncomeReport();

            // call the GenerateSalesData method
            SalesData[] salesData = report.GenerateSalesData();


            // call the QuarterlySalesReport method
            report.QuarterlySalesReport(salesData);

        }

        /* public struct SalesData includes the following fields: date sold, department name, product ID, quantity sold, unit price */
        public struct SalesData
        {
            public DateOnly dateSold;
            public string departmentName;
            public string productID;
            public int quantitySold;
            public double unitPrice;
            public double baseCost;
            public int volumeDiscount;
        }

        public struct ProdDepartments
        {
            public static string[] departmentNames = { "Men's Clothing", "Women's Clothing", "Children's Clothing", "Accessories", "Footwear", "Outerwear", "Sportswear", "Undergarments" };
            public static string[] departmentAbbreviations = { "MENS", "WOMN", "CHLD", "ACCS", "FOOT", "OUTR", "SPRT", "UNDR" };
        }

        public struct ManufacturingSites
        {
            public static string[] manufacturingSites = { "US1", "US2", "US3", "UK1", "UK2", "UK3", "JP1", "JP2", "JP3", "CA1" };
        }

        /* the GenerateSalesData method returns 1000 SalesData records. It assigns random values to each field of the data structure */
        public SalesData[] GenerateSalesData()
        {
            SalesData[] salesData = new SalesData[1000];
            Random random = new Random();

            for (int i = 0; i < 1000; i++)
            {
                salesData[i].dateSold = new DateOnly(2023, random.Next(1, 13), random.Next(1, 29));
                salesData[i].departmentName = ProdDepartments.departmentNames[random.Next(0, ProdDepartments.departmentNames.Length)];

                int indexOfDept = Array.IndexOf(ProdDepartments.departmentNames, salesData[i].departmentName);
                string deptAbb = ProdDepartments.departmentAbbreviations[indexOfDept];
                string firstDigit = (indexOfDept + 1).ToString();
                string nextTwoDigits = random.Next(1, 100).ToString("D2");
                string sizeCode = new string[] { "XS", "S", "M", "L", "XL" }[random.Next(0, 5)];
                string colorCode = new string[] { "BK", "BL", "GR", "RD", "YL", "OR", "WT", "GY" }[random.Next(0, 8)];
                string manufacturingSite = ManufacturingSites.manufacturingSites[random.Next(0, ManufacturingSites.manufacturingSites.Length)];

                salesData[i].productID = $"{deptAbb}-{firstDigit}{nextTwoDigits}-{sizeCode}-{colorCode}-{manufacturingSite}";
                salesData[i].quantitySold = random.Next(1, 101);
                salesData[i].unitPrice = random.Next(25, 300) + random.NextDouble();
                salesData[i].baseCost = salesData[i].unitPrice * (1 - (random.Next(5, 21) / 100.0));
                salesData[i].volumeDiscount = (int)(salesData[i].quantitySold * 0.1);

            }

            return salesData;
        }


        public void QuarterlySalesReport(SalesData[] salesData)
        {
            // create a dictionary to store the quarterly sales data
            Dictionary<string, double> quarterlySales = new Dictionary<string, double>();
            Dictionary<string, double> quarterlyProfit = new Dictionary<string, double>();
            Dictionary<string, double> quarterlyProfitPercentage = new Dictionary<string, double>();

            // create a dictionary to store the quarterly sales data by department
            Dictionary<string, Dictionary<string, double>> quarterlySalesByDepartment = new Dictionary<string, Dictionary<string, double>>();
            Dictionary<string, Dictionary<string, double>> quarterlyProfitByDepartment = new Dictionary<string, Dictionary<string, double>>();
            Dictionary<string, Dictionary<string, double>> quarterlyProfitPercentageByDepartment = new Dictionary<string, Dictionary<string, double>>();

            // create a dictionary to store the top 3 sales orders by quarter
            Dictionary<string, List<SalesData>> top3SalesOrdersByQuarter = new Dictionary<string, List<SalesData>>();

            // iterate through the sales data
            foreach (SalesData data in salesData)
            {
            // calculate the total sales for each quarter
            string quarter = GetQuarter(data.dateSold.Month);
            double totalSales = data.quantitySold * data.unitPrice;
            double totalCost = data.quantitySold * data.baseCost;
            double profit = totalSales - totalCost;
            double profitPercentage = (profit / totalSales) * 100;

            // calculate the total sales, profit, and profit percentage by department
            if (!quarterlySalesByDepartment.ContainsKey(quarter))
            {
                quarterlySalesByDepartment.Add(quarter, new Dictionary<string, double>());
                quarterlyProfitByDepartment.Add(quarter, new Dictionary<string, double>());
                quarterlyProfitPercentageByDepartment.Add(quarter, new Dictionary<string, double>());
            }

            if (quarterlySalesByDepartment[quarter].ContainsKey(data.departmentName))
            {
                quarterlySalesByDepartment[quarter][data.departmentName] += totalSales;
                quarterlyProfitByDepartment[quarter][data.departmentName] += profit;
            }
            else
            {
                quarterlySalesByDepartment[quarter].Add(data.departmentName, totalSales);
                quarterlyProfitByDepartment[quarter].Add(data.departmentName, profit);
            }

            if (!quarterlyProfitPercentageByDepartment[quarter].ContainsKey(data.departmentName))
            {
                quarterlyProfitPercentageByDepartment[quarter].Add(data.departmentName, profitPercentage);
            }

            // calculate the total sales and profit for each quarter
            if (quarterlySales.ContainsKey(quarter))
            {
                quarterlySales[quarter] += totalSales;
                quarterlyProfit[quarter] += profit;
            }
            else
            {
                quarterlySales.Add(quarter, totalSales);
                quarterlyProfit.Add(quarter, profit);
            }

            if (!quarterlyProfitPercentage.ContainsKey(quarter))
            {
                quarterlyProfitPercentage.Add(quarter, profitPercentage);
            }

            // add the sales data to the top 3 sales orders by quarter
            if (!top3SalesOrdersByQuarter.ContainsKey(quarter))
            {
                top3SalesOrdersByQuarter.Add(quarter, new List<SalesData>());
            }

            top3SalesOrdersByQuarter[quarter].Add(data);
            }

            // sort the top 3 sales orders by profit in descending order
            foreach (var quarter in top3SalesOrdersByQuarter.Keys)
            {
            top3SalesOrdersByQuarter[quarter] = top3SalesOrdersByQuarter[quarter]
                .OrderByDescending(order => (order.quantitySold * order.unitPrice) - (order.quantitySold * order.baseCost))
                .Take(3)
                .ToList();
            }

            // display the quarterly sales report
            Console.WriteLine("Quarterly Sales Report");
            Console.WriteLine("----------------------");

            // sort the quarterly sales by key (quarter)
            var sortedQuarterlySales = quarterlySales.OrderBy(q => q.Key);

            foreach (KeyValuePair<string, double> quarter in sortedQuarterlySales)
            {
            // format the sales amount as currency using regional settings
            string formattedSalesAmount = quarter.Value.ToString("C");
            string formattedProfitAmount = quarterlyProfit[quarter.Key].ToString("C");
            string formattedProfitPercentage = quarterlyProfitPercentage[quarter.Key].ToString("F2");

            Console.WriteLine("{0}: Sales: {1}, Profit: {2}, Profit Percentage: {3}%", quarter.Key, formattedSalesAmount, formattedProfitAmount, formattedProfitPercentage);

            // display the quarterly sales, profit, and profit percentage by department
            Console.WriteLine("By Department:");
            var sortedQuarterlySalesByDepartment = quarterlySalesByDepartment[quarter.Key].OrderBy(d => d.Key);

            // Print table headers
            Console.WriteLine("┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┐");
            Console.WriteLine("│      Department       │       Sales       │       Profit      │ Profit Percentage │");
            Console.WriteLine("├───────────────────────┼───────────────────┼───────────────────┼───────────────────┤");

            foreach (KeyValuePair<string, double> department in sortedQuarterlySalesByDepartment)
            {
                string formattedDepartmentSalesAmount = department.Value.ToString("C");
                string formattedDepartmentProfitAmount = quarterlyProfitByDepartment[quarter.Key][department.Key].ToString("C");
                string formattedDepartmentProfitPercentage = quarterlyProfitPercentageByDepartment[quarter.Key][department.Key].ToString("F2");

                Console.WriteLine("│ {0,-22}│ {1,17} │ {2,17} │ {3,17} │", department.Key, formattedDepartmentSalesAmount, formattedDepartmentProfitAmount, formattedDepartmentProfitPercentage);
            }

            Console.WriteLine("└───────────────────────┴───────────────────┴───────────────────┴───────────────────┘");
            Console.WriteLine();

            // display the top 3 sales orders for the quarter
            Console.WriteLine("Top 3 Sales Orders:");
            var top3SalesOrders = top3SalesOrdersByQuarter[quarter.Key];

            // Print table headers
            Console.WriteLine("┌───────────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┐");
            Console.WriteLine("│      Product ID       │   Quantity Sold   │    Unit Price     │   Total Sales     │      Profit       │ Profit Percentage │");
            Console.WriteLine("├───────────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┤");

            foreach (SalesData salesOrder in top3SalesOrders)
            {
                double orderTotalSales = salesOrder.quantitySold * salesOrder.unitPrice;
                double orderProfit = orderTotalSales - (salesOrder.quantitySold * salesOrder.baseCost);
                double orderProfitPercentage = (orderProfit / orderTotalSales) * 100;

                Console.WriteLine("│ {0,-22}│ {1,17} │ {2,17} │ {3,17} │ {4,17} │ {5,17} │", salesOrder.productID, salesOrder.quantitySold, salesOrder.unitPrice.ToString("C"), orderTotalSales.ToString("C"), orderProfit.ToString("C"), orderProfitPercentage.ToString("F2"));
            }

            Console.WriteLine("└───────────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┘");
            Console.WriteLine();
            }
        }

        public string GetQuarter(int month)
        {
            if (month >= 1 && month <= 3)
            {
                return "Q1";
            }
            else if (month >= 4 && month <= 6)
            {
                return "Q2";
            }
            else if (month >= 7 && month <= 9)
            {
                return "Q3";
            }
            else
            {
                return "Q4";
            }
        }
    }
}

```
